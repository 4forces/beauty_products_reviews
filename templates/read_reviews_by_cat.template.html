{% extends 'main.template.html' %}

{% block title %}Reviews for {{current_cat.name}}{% endblock %}

{% block content %}

    <div class="container-flex">
        <div class="row justify-content-center mx-0">
            <div class="col-sm-8 text-center">
                <p>{{ current_cat.desc}}</p>
            </div>
        </div>
        <div class="row justify-content-around px-3 mx-0">

                <div class="card-columns">
                    {% for r in reviews %}
                    <div class="card" data-aos="fade-up" data-aos-delay="20">
                        {% if r.image %}
                        <a href="{{ url_for('view_review_details', review_id=r._id)}}">
                        <img src="{{r.image}}-/resize/355x/" class="card-img-top" alt="{{r.product_name}}">
                        </a>
                        {% endif %}
                        <div class="card-body">
                        <p class="card-text">{{r.product_name}}<br/>
                        {{r.product_brand}} from {{r.country_of_origin}}<br/>
                            {% set rating = r.rating | int %}
                            {% for i in range(0,rating) %}
                                <span class="pink-text stars"> <i class="fas fa-star"></i></span>
                            {% endfor %}
                        </p>
                        <h5 class="card-title pink-text mb-0 pb-0">
                            <a href="{{ url_for('view_review_details', review_id=r._id)}}">
                            {{r.title}}
                            </a>
                        </h5>
                        <p class="card-text">{{ r.review }}</p>
                        
                        {% set _stub = all_users.rewind() %}

                        <p class="card-text"><small class="text-muted">Posted by {% for u in all_users if r.user_id==u._id %}{{u.name}}{% endfor%} on {{r.posted.strftime("%d-%m-%Y, %H:%M:%S")}}</small></p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
{% endblock %}